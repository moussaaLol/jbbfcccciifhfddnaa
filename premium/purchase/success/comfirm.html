<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>NazAPI • Confirmation</title>
<meta name="color-scheme" content="dark light" />
<style>
  :root{
    --bg: #0b0f1a;
    --card: rgba(255,255,255,0.06);
    --card-strong: rgba(255,255,255,0.12);
    --text: #e8ecf1;
    --muted: #9fb2c8;
    --accent: #6de1ff;
    --ok: #3ad29f;
    --warn: #ffd166;
    --danger:#ff6b6b;
    --ring: rgba(109,225,255,.35);
    --shadow: 0 10px 30px rgba(0,0,0,.35), inset 0 0 0 1px rgba(255,255,255,.05);
    --radius: 18px;
  }
  html,body{height:100%}
  body{
    margin:0; font-family: ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,Inter,Arial;
    color:var(--text); background: radial-gradient(1200px 800px at 15% -10%,#16223a 0%,transparent 60%),
                       radial-gradient(1000px 700px at 85% -5%,#1a2d4b 0%,transparent 60%),
                       radial-gradient(1200px 900px at 50% 110%,#111a2a 0%,transparent 60%), var(--bg);
    background-attachment: fixed;
    overflow-y: auto;
    display: flex;
    justify-content: center;
    align-items: center;
    min-height: 100vh;
  }
  /* étoiles */
  .stars, .stars2, .stars3{
    position:fixed; inset:0; pointer-events:none; background-repeat:repeat; z-index:-1; opacity:.6;
    background-image: radial-gradient(1px 1px at 20px 30px,#fff,transparent 50%),
                      radial-gradient(1px 1px at 80px 120px,#fff,transparent 50%),
                      radial-gradient(1px 1px at 200px 80px,#fff,transparent 50%),
                      radial-gradient(1px 1px at 320px 40px,#fff,transparent 50%),
                      radial-gradient(1px 1px at 440px 160px,#fff,transparent 50%);
    animation: twinkle 16s linear infinite;
  }
  .stars2{ animation-duration:22s; opacity:.4; transform:scale(1.2) }
  .stars3{ animation-duration:30s; opacity:.25; transform:scale(1.4) }
  @keyframes twinkle { 0%{filter:brightness(.9)} 50%{filter:brightness(1.1)} 100%{filter:brightness(.9)} }

  .wrap{ max-width:600px; margin:auto; padding:32px 20px; }
  .brand{ display:flex; align-items:center; gap:12px; justify-content: center; margin-bottom: 30px; }
  .logo{
    width:60px; height:60px; border-radius:16px; background:
      radial-gradient(18px 14px at 14px 14px, #6de1ff 0%, #4cc2ff 35%, transparent 60%),
      conic-gradient(from 220deg,#6de1ff, #7c6dff, #eb6cff, #6de1ff);
    box-shadow: 0 0 30px rgba(109,225,255,.4), inset 0 0 0 2px rgba(255,255,255,.07);
  }
  h1{ font-size:28px; margin:0; letter-spacing:.3px; text-align: center; }
  .card{
    background: var(--card); border-radius: var(--radius); box-shadow: var(--shadow);
    backdrop-filter: blur(10px); -webkit-backdrop-filter: blur(10px);
    padding:40px 30px; border:1px solid rgba(255,255,255,.06);
    text-align: center;
  }
  .muted{ color:var(--muted) }
  .btn{
    appearance:none; border:0; padding:12px 24px; border-radius:14px; font-weight:600; cursor:pointer;
    background: linear-gradient(180deg, #1d2a42, #141c2b); color:#eaf7ff;
    box-shadow: var(--shadow); transition: transform .05s ease, box-shadow .2s ease;
    margin-top: 20px;
  }
  .btn:hover{ box-shadow: 0 14px 36px rgba(109,225,255,.25), inset 0 0 0 1px var(--ring) }
  .btn:active{ transform: translateY(1px) }
  .btn.ok{ background: linear-gradient(180deg, #1f3a34, #122722) }
  .btn.secondary{ background: linear-gradient(180deg, #232b3b, #1a2230) }
  
  /* Checkmark animation */
  .checkmark-container {
    width: 100px;
    height: 100px;
    margin: 0 auto 30px;
    position: relative;
  }
  .checkmark-circle {
    stroke-dasharray: 300;
    stroke-dashoffset: 300;
    stroke-width: 3;
    stroke: var(--ok);
    fill: none;
    animation: draw-circle 1s ease-in-out forwards;
  }
  .checkmark {
    stroke-dasharray: 100;
    stroke-dashoffset: 100;
    stroke-width: 4;
    stroke: var(--ok);
    stroke-linecap: round;
    stroke-linejoin: round;
    fill: none;
    animation: draw-check 0.8s ease-in-out 0.8s forwards;
  }
  @keyframes draw-circle {
    to { stroke-dashoffset: 0; }
  }
  @keyframes draw-check {
    to { stroke-dashoffset: 0; }
  }
  
  .confirmation-text {
    font-size: 24px;
    margin-bottom: 15px;
    color: var(--ok);
    font-weight: 600;
  }
  
  .order-details {
    background: rgba(255, 255, 255, 0.03);
    border-radius: 12px;
    padding: 20px;
    margin: 25px 0;
    text-align: left;
  }
  
  .detail-row {
    display: flex;
    justify-content: space-between;
    margin-bottom: 10px;
  }
  
  .detail-label {
    color: var(--muted);
  }
  
  .detail-value {
    font-weight: 500;
  }
  
  .note {
    font-size: 14px;
    color: var(--muted);
    margin-top: 25px;
    line-height: 1.5;
  }
  
  .footer{
    opacity:.85; margin-top:40px; padding:16px; text-align:center; font-size:13px; color:var(--muted)
  }
  
  /* Verification styles */
  .user-verification {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 20px;
    margin: 25px 0;
  }
  
  .user-info {
    display: flex;
    align-items: center;
    gap: 15px;
    background: rgba(255, 255, 255, 0.03);
    padding: 15px;
    border-radius: 12px;
    width: 100%;
    max-width: 350px;
  }
  
  .user-avatar {
    width: 60px;
    height: 60px;
    border-radius: 50%;
    background: linear-gradient(45deg, #6de1ff, #7c6dff);
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: bold;
    font-size: 24px;
  }
  
  .user-details {
    text-align: left;
  }
  
  .username {
    font-weight: 600;
    margin-bottom: 5px;
  }
  
  .user-id {
    font-size: 12px;
    color: var(--muted);
  }
  
  .verification-buttons {
    display: flex;
    gap: 15px;
    margin-top: 10px;
  }
  
  .not-me {
    color: var(--accent);
    cursor: pointer;
    text-decoration: underline;
    margin-top: 15px;
  }
  
  .hidden {
    display: none;
  }
</style>
</head>
<body>
<div class="stars"></div><div class="stars2"></div><div class="stars3"></div>

<div class="wrap">
  <div class="brand">
    <div class="logo" aria-hidden="true"></div>
    <div>
      <h1>NazAPI • Confirmation</h1>
      <div class="muted" style="font-size:13px; text-align: center;">Merci pour votre confiance</div>
    </div>
  </div>

  <div class="card">
    <!-- Verification Section (shown first) -->
    <div id="verificationSection">
      <h2 style="margin-bottom: 20px;">Confirmation de paiement</h2>
      <p class="muted">Nous avons besoin de confirmer votre identité pour finaliser votre achat.</p>
      
      <div class="user-verification">
        <div class="user-info">
          <div class="user-avatar" id="userAvatar">U</div>
          <div class="user-details">
            <div class="username" id="username">Utilisateur</div>
            <div class="user-id" id="userId">ID: Chargement...</div>
          </div>
        </div>
        
        <div style="text-align: center;">
          <div style="margin-bottom: 10px; font-weight: 500;">Est-ce vous?</div>
          <div class="verification-buttons">
            <button class="btn ok" id="confirmButton">Oui, c'est moi</button>
            <button class="btn secondary" id="cancelButton">Non, ce n'est pas moi</button>
          </div>
        </div>
      </div>
    </div>
    
    <!-- Confirmation Section (shown after verification) -->
    <div id="confirmationSection" class="hidden">
      <div class="checkmark-container">
        <svg viewBox="0 0 100 100">
          <circle class="checkmark-circle" cx="50" cy="50" r="45" />
          <path class="checkmark" d="M30,50 L45,65 L70,35" />
        </svg>
      </div>
      
      <div class="confirmation-text">Merci pour votre achat !</div>
      <p class="muted">Votre abonnement Premium a été activé avec succès.</p>
      
      <div class="order-details">
        <div class="detail-row">
          <span class="detail-label">Produit:</span>
          <span class="detail-value">NazAPI Premium</span>
        </div>
        <div class="detail-row">
          <span class="detail-label">Durée:</span>
          <span class="detail-value">30 jours</span>
        </div>
        <div class="detail-row">
          <span class="detail-label">Prix:</span>
          <span class="detail-value">16,99 €</span>
        </div>
        <div class="detail-row">
          <span class="detail-label">Date d'activation:</span>
          <span class="detail-value" id="activationDate">20 novembre 2023</span>
        </div>
        <div class="detail-row">
          <span class="detail-label">Expiration:</span>
          <span class="detail-value" id="expirationDate">20 décembre 2023</span>
        </div>
      </div>
      
      <p class="note">
        Votre rôle Premium a été attribué sur Discord. Vous pouvez maintenant accéder à toutes les fonctionnalités exclusives.
      </p>
      
      <button class="btn ok" onclick="window.location.href='/'">Retour à l'accueil</button>
    </div>
  </div>

  <footer class="footer">
    <div>© <span id="year"></span> NazAPI • <span class="muted">research services ✦</span></div>
  </footer>
</div>

<script>
  document.addEventListener('DOMContentLoaded', function() {
    // Set current year in footer
    document.getElementById('year').textContent = new Date().getFullYear();
    
    // Check if user came from a payment redirect
    const urlParams = new URLSearchParams(window.location.search);
    const paymentCompleted = urlParams.get('payment_completed');
    const userId = urlParams.get('user_id');
    
    // If not from a payment redirect, go back to homepage
    if (!paymentCompleted || !userId) {
      window.location.href = '/';
      return;
    }
    
    // Simulate user data (in a real scenario, you'd fetch this from your backend)
    const userData = {
      id: userId,
      username: 'NazAPIUser',
      discriminator: '1234',
      avatar: null
    };
    
    // Display user information
    document.getElementById('username').textContent = `${userData.username}#${userData.discriminator}`;
    document.getElementById('userId').textContent = `ID: ${userData.id}`;
    
    // Set avatar initial
    document.getElementById('userAvatar').textContent = userData.username.charAt(0);
    
    // Set dates
    const now = new Date();
    const expiration = new Date();
    expiration.setDate(expiration.getDate() + 30);
    
    const options = { day: 'numeric', month: 'long', year: 'numeric' };
    document.getElementById('activationDate').textContent = now.toLocaleDateString('fr-FR', options);
    document.getElementById('expirationDate').textContent = expiration.toLocaleDateString('fr-FR', options);
    
    // Confirm button handler
    document.getElementById('confirmButton').addEventListener('click', function() {
      // Show loading state
      this.textContent = 'Traitement...';
      this.disabled = true;
      
      // Simulate API call to assign Discord role
      setTimeout(function() {
        // Hide verification, show confirmation
        document.getElementById('verificationSection').classList.add('hidden');
        document.getElementById('confirmationSection').classList.remove('hidden');
      }, 1500);
    });
    
    // Cancel button handler
    document.getElementById('cancelButton').addEventListener('click', function() {
      // Redirect to Discord OAuth for reauthentication
      const discordAuthUrl = `https://discord.com/oauth2/authorize?client_id=1407764995671986249&redirect_uri=${encodeURIComponent(window.location.origin + window.location.pathname)}&response_type=token&scope=identify&state=reauth`;
      window.location.href = discordAuthUrl;
    });
  });
</script>
</body>
</html>
